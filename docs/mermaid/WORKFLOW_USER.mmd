sequenceDiagram
    participant User as User
    participant Client as Blazor Client
    participant Server as ASP.NET Server
    participant JokeAPI as JokeAPI
    participant OpenAI as Azure OpenAI
    participant Storage as Table Storage

    User->>Client: 1. Clicks Start
    Note over Client: PerformanceOrchestrator<br/>transitions to Fetching
    Client->>Server: 2. GET /api/jokes/fetch
    Server->>JokeAPI: 3. Fetch random joke
    JokeAPI-->>Server: 4. Return JokeDto
    Server-->>Client: 5. Return JokeDto
    
    Note over Client: Displays Setup<br/>Shows AI Guess loading
    Client->>Server: 6. POST /api/jokes/analyze<br/>(with joke.Setup)
    Server->>OpenAI: 7. Prompt: Guess punchline
    OpenAI-->>Server: 8. Return AI punchline
    Note over Server: Calculate similarity<br/>(Levenshtein + Jaccard)
    Server-->>Client: 9. Return JokeAnalysisDto<br/>+ similarity score
    
    Note over Client: Displays AI Guess<br/>Shows punchline reveal
    Client->>Server: 10. POST /api/leaderboards<br/>(save result)
    Server->>Storage: 11. Write to leaderboard
    Storage-->>Server: 12. Ack
    Server-->>Client: 13. Leaderboard updated
    
    Note over Client: Displays Result<br/>- Triumph/Defeat animation<br/>- Commentary bubble<br/>- Updated stats

    rect rgb(200, 220, 255)
    Note over Client,Storage: Click Start again or Stop<br/>to end performance
    end
