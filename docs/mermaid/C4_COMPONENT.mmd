graph TB
    subgraph Client["Po.Joker.Client"]
        JesterStage["JesterStage.razor<br/>Main Container"]
        PerfDisplay["PerformanceDisplay.razor<br/>Shows joke/results"]
        PerfControls["PerformanceControls.razor<br/>Start/Stop buttons"]
        Overlays["SpeechlessJester<br/>NetworkAwaiting<br/>Error Overlays"]
        PerfOrch["PerformanceOrchestrator<br/>State Machine<br/>Orchestration"]
        ClientServices["HttpClient<br/>Speech/Audio Services"]
    end

    subgraph Server["Po.Joker (Server)"]
        Endpoints["API Endpoints<br/>- /api/jokes/fetch<br/>- /api/jokes/analyze<br/>- /api/leaderboards<br/>- /api/diagnostics"]
        
        CQRS["CQRS Handlers<br/>- FetchJokeHandler<br/>- AnalyzeJokeHandler<br/>- GetLeaderboardHandler<br/>- GetDiagnosticsHandler"]
        
        Services["Domain Services<br/>- AiJesterService<br/>- JokeApiClient<br/>- TableStorageClient<br/>- HealthCheck"]
        
        Config["DI Configuration<br/>- AzureServices<br/>- MediatR Setup<br/>- HttpClient Setup"]
    end

    subgraph Shared["Po.Joker.Shared"]
        DTOs["DTOs<br/>- JokeDto<br/>- JokeAnalysisDto<br/>- JokeRatingDto"]
        
        Contracts["Contracts<br/>- IAnalysisService<br/>- IJokeApiClient<br/>- Enums & Validation"]
    end

    subgraph External["External Services"]
        OpenAI["Azure OpenAI<br/>gpt-4o-mini"]
        JokeAPI["JokeAPI v2"]
        TableStore["Azure Table Storage"]
    end

    JesterStage --> PerfDisplay
    JesterStage --> PerfControls
    JesterStage --> Overlays
    JesterStage --> PerfOrch
    PerfOrch --> ClientServices
    
    ClientServices -->|HTTP| Endpoints
    Endpoints --> CQRS
    CQRS --> Services
    Services --> OpenAI
    Services --> JokeAPI
    Services --> TableStore
    
    CQRS -.->|Uses| DTOs
    Services -.->|Uses| Contracts
    ClientServices -.->|Uses| DTOs
